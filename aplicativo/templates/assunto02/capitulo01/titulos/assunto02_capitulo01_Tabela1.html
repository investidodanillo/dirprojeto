{% extends 'assunto02\capitulo01\titulos\base.html' %}
{% load render_table from django_tables2 %}
{% load static %}

{% block titudos %}
<main class="main-content">

    <h1>TABELA1</h1>
    {% if mensagem %}
    <p>{{ mensagem }}</p>
    {% else %}
    <p></p>
    {% endif %}




    <!-- Filtro -->
    <section class="filtro-section fade-in">
        <form method="get" class="filtro-form" id="filtroForm">
            <div class="filtro-grid">
                {% for field in filter.form %}
                <div class="filtro-field">
                    {{ field.label_tag }}
                    {{ field }}
                    {% if field.errors %}
                    <div class="field-error">{{ field.errors }}</div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <div class="assunto03-form">
                <div class="button-group destaque-botoes">
                    <button class="btn btn-glass btn-salvar" type="submit">
                        <i class="fas fa-search"></i> Filtrar
                    </button>
                    <a href="{% url 'assunto02:assunto02_capitulo01_Tabela1ListView' %}"
                        class="btn btn-glass btn-limpar" id="btnLimpar">
                        <i class="fas fa-undo"></i> Limpar
                    </a>
                    <a href="{% url 'assunto02:assunto02_capitulo01_cadastro_View' %}" class="btn btn-glass btn-novo">
                        <i class="fas fa-plus"></i></i> Novo Registro
                    </a>
                </div>
            </div>
        </form>
    </section>

    <!-- Tabela -->
    <section class="table-section fade-in">

        {% render_table table %}

    </section>

    <!-- Paginação -->
    {% if is_paginated %}
    <div class="pagination fade-in">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}" class="glass-button btn-sm">‹ Anterior</a>
        {% endif %}

        <span class="pagination-info">
            Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="glass-button btn-sm">Próxima ›</a>
        {% endif %}
    </div>
    {% endif %}
</main>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Função para exibir mensagens temporárias
        function mostrarMensagem(texto, tipo) {
            const mensagemDiv = document.getElementById('mensagem');
            if (mensagemDiv) {
                mensagemDiv.textContent = texto;
                mensagemDiv.style.display = 'block';

                setTimeout(function () {
                    mensagemDiv.style.display = 'none';
                }, 5000);
            }
        }

        // Adicionar eventos de foco nos campos de filtro
        const camposFiltro = document.querySelectorAll('.filtro-field input, .filtro-field select');
        camposFiltro.forEach(campo => {
            campo.addEventListener('focus', function () {
                this.parentElement.classList.add('focused');
            });

            campo.addEventListener('blur', function () {
                this.parentElement.classList.remove('focused');
            });
        });

        // Feedback visual ao enviar formulário
        const filtroForm = document.getElementById('filtroForm');
        if (filtroForm) {
            filtroForm.addEventListener('submit', function () {
                mostrarMensagem('Aplicando filtros...', 'info');
            });
        }
    });
</script>
{% endblock titudos %}